# Baleno 會員忠誠度 App - 系統架構設計文件

**System Architecture Design Document**

| 項目 | 內容 |
|------|------|
| 文件版本 | 1.0 |
| 建立日期 | 2025-12-05 |
| 最後更新 | 2025-12-05 |
| 專案名稱 | Baleno Membership Loyalty App |

---

## 1. 架構概述

### 1.1 架構模式

本專案採用 **MVP (Model-View-Presenter)** 架構模式，實現關注點分離，提升程式碼的可維護性和可測試性。

```
┌─────────────────────────────────────────────────────────────┐
│                         View Layer                          │
│              (React Native Components / Screens)            │
│                                                             │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │
│  │  Home   │  │ Points  │  │ Coupons │  │Settings │        │
│  │ Screen  │  │ Screen  │  │ Screen  │  │ Screen  │        │
│  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘        │
│       │            │            │            │              │
└───────┼────────────┼────────────┼────────────┼──────────────┘
        │            │            │            │
        ▼            ▼            ▼            ▼
┌─────────────────────────────────────────────────────────────┐
│                      Presenter Layer                         │
│                    (Business Logic)                          │
│                                                             │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │
│  │  Home   │  │ Points  │  │ Coupon  │  │Settings │        │
│  │Presenter│  │Presenter│  │Presenter│  │Presenter│        │
│  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘        │
│       │            │            │            │              │
└───────┼────────────┼────────────┼────────────┼──────────────┘
        │            │            │            │
        ▼            ▼            ▼            ▼
┌─────────────────────────────────────────────────────────────┐
│                       Service Layer                          │
│                      (API / Data)                            │
│                                                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐    │
│  │apiClient │  │authService│  │pointsServ│  │couponServ│    │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
        │
        ▼
┌─────────────────────────────────────────────────────────────┐
│                       Model Layer                            │
│                    (Data Models)                             │
│                                                             │
│     ┌────────┐    ┌────────┐    ┌────────┐                 │
│     │ Member │    │ Points │    │ Coupon │                 │
│     └────────┘    └────────┘    └────────┘                 │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 1.2 架構選型理由

| 架構模式 | 選擇原因 |
|----------|----------|
| **MVP** | - 清晰的關注點分離<br>- View 與業務邏輯解耦<br>- 便於單元測試 Presenter<br>- 適合中型 React Native 專案 |
| **Context API** | - 內建於 React，無需額外依賴<br>- 適合全局狀態（認證、語言）<br>- 簡單易用，學習曲線低 |
| **Expo Router** | - 基於檔案的路由系統<br>- 類似 Next.js 的開發體驗<br>- 內建深度連結支援 |

---

## 2. 技術棧

### 2.1 核心技術

| 技術 | 版本 | 用途 |
|------|------|------|
| React Native | 0.81.4 | 跨平台移動應用框架 |
| Expo SDK | 54 | 開發工具和原生模組 |
| TypeScript | 5.9.2 | 靜態類型檢查 |
| React | 19.1.0 | UI 組件庫 |

### 2.2 導航與路由

| 技術 | 版本 | 用途 |
|------|------|------|
| Expo Router | 6.0.7 | 基於檔案的路由系統 |
| React Navigation | 7.x | 底層導航實現 |

### 2.3 狀態管理與資料

| 技術 | 用途 |
|------|------|
| React Context API | 全局狀態管理（認證、語言） |
| AsyncStorage | 持久化儲存（語言偏好） |
| expo-secure-store | 安全儲存（JWT Token） |

### 2.4 國際化

| 技術 | 版本 | 用途 |
|------|------|------|
| i18next | 25.7.1 | 國際化框架 |
| react-i18next | 16.3.5 | React 綁定 |
| expo-localization | 17.0.7 | 設備語言檢測 |

### 2.5 UI 與樣式

| 技術 | 用途 |
|------|------|
| React Native StyleSheet | 樣式定義 |
| @expo/vector-icons | 圖標庫（Ionicons） |
| react-native-svg | SVG 渲染 |
| react-native-qrcode-svg | QR Code 生成 |

### 2.6 其他 Expo 模組

| 模組 | 用途 |
|------|------|
| expo-notifications | 推送通知 |
| expo-device | 設備資訊 |
| expo-haptics | 觸覺反饋 |
| expo-splash-screen | 啟動畫面 |

---

## 3. 目錄結構

```
/
├── app/                          # 頁面層 (View - Expo Router)
│   ├── (auth)/                   # 認證相關頁面群組
│   │   ├── login.tsx             # 登入頁面
│   │   └── register.tsx          # 註冊頁面
│   ├── (tabs)/                   # 主要標籤頁群組
│   │   ├── index.tsx             # 主頁 (Home)
│   │   ├── points.tsx            # 積分頁面
│   │   ├── coupons.tsx           # 優惠券頁面
│   │   ├── settings.tsx          # 設定頁面
│   │   └── _layout.tsx           # 標籤導航佈局
│   ├── _layout.tsx               # 根佈局 (Providers)
│   └── +not-found.tsx            # 404 頁面
│
├── src/                          # 源碼目錄
│   ├── models/                   # Model 層 - 資料模型
│   │   ├── Member.ts             # 會員資料模型
│   │   ├── Points.ts             # 積分/交易模型
│   │   ├── Coupon.ts             # 優惠券模型
│   │   └── index.ts              # 匯出索引
│   │
│   ├── presenters/               # Presenter 層 - 業務邏輯
│   │   ├── AuthPresenter.ts      # 認證邏輯
│   │   ├── HomePresenter.ts      # 主頁邏輯
│   │   ├── PointsPresenter.ts    # 積分邏輯
│   │   ├── CouponPresenter.ts    # 優惠券邏輯
│   │   ├── SettingsPresenter.ts  # 設定邏輯
│   │   └── index.ts              # 匯出索引
│   │
│   ├── services/                 # Service 層 - API 與資料存取
│   │   ├── apiClient.ts          # HTTP 客戶端
│   │   ├── authService.ts        # 認證 API
│   │   ├── pointsService.ts      # 積分 API
│   │   ├── couponService.ts      # 優惠券 API
│   │   ├── notificationService.ts# 推送通知服務
│   │   ├── mockData.ts           # 模擬資料
│   │   └── index.ts              # 匯出索引
│   │
│   ├── contexts/                 # React Context
│   │   ├── AuthContext.tsx       # 認證狀態管理
│   │   ├── LanguageContext.tsx   # 語言狀態管理
│   │   └── index.ts              # 匯出索引
│   │
│   ├── components/               # 共用 UI 組件
│   │   ├── Button.tsx            # 按鈕組件
│   │   ├── Card.tsx              # 卡片組件
│   │   ├── Input.tsx             # 輸入框組件
│   │   ├── LoadingOverlay.tsx    # 載入遮罩
│   │   └── index.ts              # 匯出索引
│   │
│   ├── localization/             # 國際化
│   │   ├── translations/         # 翻譯檔案
│   │   │   ├── zh-HK.ts          # 繁體中文
│   │   │   ├── zh-CN.ts          # 簡體中文
│   │   │   └── en.ts             # 英文
│   │   ├── i18n.ts               # i18next 配置
│   │   └── index.ts              # 匯出索引
│   │
│   ├── types/                    # TypeScript 類型定義
│   │   ├── api.ts                # API 相關類型
│   │   └── navigation.ts         # 導航類型
│   │
│   └── utils/                    # 工具函數
│
├── components/                   # Expo 預設主題組件
│   ├── ThemedText.tsx            # 主題文字組件
│   └── ThemedView.tsx            # 主題視圖組件
│
├── constants/                    # 常數定義
│   └── Colors.ts                 # 顏色常數
│
├── hooks/                        # 自定義 Hooks
│   └── useThemeColor.ts          # 主題顏色 Hook
│
├── assets/                       # 靜態資源
│   ├── images/                   # 圖片資源
│   └── fonts/                    # 字體資源
│
└── docs/                         # 設計文件
    ├── SRS-需求規格說明書.md
    └── 系統架構設計文件.md
```

---

## 4. MVP 架構詳解

### 4.1 Model 層

**職責**：定義資料結構和類型

```typescript
// src/models/Member.ts
export interface Member {
  id: string;
  name: string;
  email: string;
  phone: string;
  membershipTier: 'standard' | 'silver' | 'gold' | 'platinum';
  joinDate: string;
  avatarUrl?: string;
}
```

```typescript
// src/models/Points.ts
export interface PointsBalance {
  currentPoints: number;
  expiringPoints: number;
  expiryDate?: string;
}

export interface Transaction {
  id: string;
  type: 'earn' | 'redeem' | 'expire' | 'adjust';
  points: number;
  description: string;
  date: string;
  storeLocation?: string;
}
```

```typescript
// src/models/Coupon.ts
export interface Coupon {
  id: string;
  title: string;
  description: string;
  pointsCost: number;
  expiryDate: string;
  imageUrl?: string;
  terms?: string;
}

export interface RedeemedCoupon extends Coupon {
  redemptionCode: string;
  redemptionDate: string;
  usedDate?: string;
}
```

### 4.2 View 層

**職責**：渲染 UI、處理用戶交互、將事件委派給 Presenter

**設計原則**：
- 不包含業務邏輯
- 不直接呼叫 API
- 透過 Presenter 回調處理數據
- 使用 `useMemo` 實例化 Presenter

```typescript
// app/(tabs)/points.tsx - View 範例
export default function PointsScreen() {
  const [pointsBalance, setPointsBalance] = useState<PointsBalance | null>(null);
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  
  // 定義 View 回調
  const callbacks: PointsViewCallbacks = useMemo(() => ({
    showLoading: () => setIsLoading(true),
    hideLoading: () => setIsLoading(false),
    showError: (message: string) => setError(message),
    renderBalance: (balance: PointsBalance) => setPointsBalance(balance),
    renderTransactions: (txns: Transaction[]) => setTransactions(txns),
  }), []);

  // 實例化 Presenter
  const presenter = useMemo(() => new PointsPresenter(callbacks), [callbacks]);

  // 頁面載入時呼叫 Presenter
  useEffect(() => {
    presenter.refresh();
  }, [presenter]);

  // 下拉刷新
  const handleRefresh = useCallback(() => {
    presenter.refresh();
  }, [presenter]);

  // 渲染 UI (純展示)
  return (
    <View>
      <Text>{presenter.formatBalance(pointsBalance?.currentPoints)}</Text>
      {/* ... */}
    </View>
  );
}
```

### 4.3 Presenter 層

**職責**：處理業務邏輯、呼叫 Service、格式化資料、透過回調更新 View

**設計原則**：
- 不直接操作 UI
- 不持有 View 引用
- 透過回調介面與 View 通訊
- 可單獨進行單元測試

```typescript
// src/presenters/PointsPresenter.ts - Presenter 範例
export interface PointsViewCallbacks {
  showLoading: () => void;
  hideLoading: () => void;
  showError: (message: string) => void;
  renderBalance: (balance: PointsBalance) => void;
  renderTransactions: (transactions: Transaction[], hasMore: boolean) => void;
}

export class PointsPresenter {
  private callbacks: PointsViewCallbacks;

  constructor(callbacks: PointsViewCallbacks) {
    this.callbacks = callbacks;
  }

  async refresh(): Promise<void> {
    this.callbacks.showLoading();
    
    try {
      const response = await pointsService.getPointsBalance();
      
      if (response.success && response.data) {
        this.callbacks.renderBalance(response.data);
      } else {
        this.callbacks.showError(response.error?.message || 'errors.unknownError');
      }
    } catch (error) {
      this.callbacks.showError('errors.networkError');
    } finally {
      this.callbacks.hideLoading();
    }
  }

  // 格式化方法 - Presenter 負責資料展示格式
  formatBalance(points: number): string {
    return points.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
  }

  formatDate(dateString: string): string {
    const date = new Date(dateString);
    return date.toLocaleDateString();
  }
}
```

### 4.4 資料流圖

```
用戶操作                View                  Presenter              Service
   │                     │                       │                      │
   │ 點擊刷新             │                       │                      │
   ├────────────────────>│                       │                      │
   │                     │ handleRefresh()       │                      │
   │                     ├──────────────────────>│                      │
   │                     │                       │ showLoading()        │
   │                     │<──────────────────────┤                      │
   │   顯示載入中          │                       │                      │
   │<────────────────────┤                       │                      │
   │                     │                       │ getPointsBalance()   │
   │                     │                       ├─────────────────────>│
   │                     │                       │                      │ API Call
   │                     │                       │<─────────────────────┤
   │                     │                       │ renderBalance(data)  │
   │                     │<──────────────────────┤                      │
   │   顯示積分            │                       │                      │
   │<────────────────────┤                       │                      │
   │                     │                       │ hideLoading()        │
   │                     │<──────────────────────┤                      │
   │   隱藏載入中          │                       │                      │
   │<────────────────────┤                       │                      │
```

---

## 5. Service 層設計

### 5.1 API Client

**職責**：封裝 HTTP 請求、處理認證 Token、統一錯誤處理

```typescript
// src/services/apiClient.ts
class ApiClient {
  private baseUrl: string = 'https://api.baleno.com/v1';
  private token: string | null = null;

  async request<T>(
    endpoint: string,
    options: RequestOptions = {}
  ): Promise<ApiResponse<T>> {
    const url = `${this.baseUrl}${endpoint}`;
    
    const headers: HeadersInit = {
      'Content-Type': 'application/json',
      ...(this.token && { Authorization: `Bearer ${this.token}` }),
    };

    try {
      const response = await fetch(url, {
        ...options,
        headers,
      });

      if (!response.ok) {
        // 處理 401 未授權
        if (response.status === 401) {
          await this.clearToken();
          // 觸發登出
        }
        throw new Error(`HTTP ${response.status}`);
      }

      return { success: true, data: await response.json() };
    } catch (error) {
      return {
        success: false,
        error: { code: 'NETWORK_ERROR', message: 'errors.networkError' },
      };
    }
  }

  // Token 管理
  async setToken(token: string): Promise<void> {
    this.token = token;
    await SecureStore.setItemAsync('authToken', token);
  }

  async loadToken(): Promise<string | null> {
    this.token = await SecureStore.getItemAsync('authToken');
    return this.token;
  }

  async clearToken(): Promise<void> {
    this.token = null;
    await SecureStore.deleteItemAsync('authToken');
  }
}

export const apiClient = new ApiClient();
```

### 5.2 Service 模組

每個功能域有獨立的 Service：

| Service | 職責 |
|---------|------|
| `authService` | 登入、註冊、登出、Token 管理 |
| `pointsService` | 積分餘額查詢、交易記錄 |
| `couponService` | 優惠券列表、兌換操作 |
| `notificationService` | 推送通知權限、Token 註冊 |

```typescript
// src/services/pointsService.ts - Service 範例
export const pointsService = {
  async getPointsBalance(): Promise<ApiResponse<PointsBalance>> {
    return apiClient.get('/members/me/points');
  },

  async getTransactionHistory(params: {
    page: number;
    pageSize: number;
  }): Promise<ApiResponse<TransactionHistoryResponse>> {
    return apiClient.get('/members/me/transactions', { params });
  },
};
```

### 5.3 Mock 資料

開發階段使用 `mockData.ts` 提供模擬資料：

```typescript
// src/services/mockData.ts
export const mockMember: Member = {
  id: 'M001234567',
  name: '陳小明',
  email: 'demo@example.com',
  phone: '+852 9123 4567',
  membershipTier: 'gold',
  joinDate: '2023-01-15',
};

export const mockPointsBalance: PointsBalance = {
  currentPoints: 2580,
  expiringPoints: 500,
  expiryDate: '2025-03-31',
};

export const mockTransactions: Transaction[] = [
  {
    id: 'TXN001',
    type: 'earn',
    points: 150,
    description: '購物消費 - 冬季外套',
    date: '2024-12-01',
    storeLocation: '銅鑼灣店',
  },
  // ...
];
```

---

## 6. 狀態管理

### 6.1 AuthContext - 認證狀態

**職責**：管理用戶認證狀態、提供登入/登出方法

```typescript
// src/contexts/AuthContext.tsx
interface AuthContextType {
  member: Member | null;
  isAuthenticated: boolean;
  isLoading: boolean;
  login: (username: string, password: string) => Promise<boolean>;
  register: (data: RegisterData) => Promise<boolean>;
  logout: () => Promise<void>;
}

export const AuthProvider: React.FC = ({ children }) => {
  const [member, setMember] = useState<Member | null>(null);
  const [isLoading, setIsLoading] = useState(true);

  // 初始化時載入已存儲的 Token
  useEffect(() => {
    const loadAuthState = async () => {
      const token = await apiClient.loadToken();
      if (token) {
        const response = await authService.getCurrentMember();
        if (response.success) {
          setMember(response.data);
        }
      }
      setIsLoading(false);
    };
    loadAuthState();
  }, []);

  const login = async (username: string, password: string) => {
    const response = await authService.login({ username, password });
    if (response.success) {
      await apiClient.setToken(response.data.token);
      setMember(response.data.member);
      return true;
    }
    return false;
  };

  const logout = async () => {
    await authService.logout();
    await apiClient.clearToken();
    setMember(null);
  };

  return (
    <AuthContext.Provider value={{ member, isAuthenticated: !!member, isLoading, login, logout }}>
      {children}
    </AuthContext.Provider>
  );
};
```

### 6.2 LanguageContext - 語言狀態

**職責**：管理 App 語言設定、持久化語言偏好

```typescript
// src/contexts/LanguageContext.tsx
interface LanguageContextType {
  language: string;
  changeLanguage: (lang: string) => Promise<void>;
}

export const LanguageProvider: React.FC = ({ children }) => {
  const [language, setLanguage] = useState('zh-HK');

  useEffect(() => {
    // 初始化時讀取已存儲的語言偏好
    const loadLanguage = async () => {
      const savedLanguage = await AsyncStorage.getItem('language');
      if (savedLanguage) {
        await i18n.changeLanguage(savedLanguage);
        setLanguage(savedLanguage);
      } else {
        // 根據設備語言設定預設值
        const deviceLanguage = getLocales()[0]?.languageTag;
        const lang = deviceLanguage?.startsWith('zh') 
          ? (deviceLanguage.includes('CN') ? 'zh-CN' : 'zh-HK')
          : 'zh-HK';
        await i18n.changeLanguage(lang);
        setLanguage(lang);
      }
    };
    loadLanguage();
  }, []);

  const changeLanguage = async (lang: string) => {
    await i18n.changeLanguage(lang);
    await AsyncStorage.setItem('language', lang);
    setLanguage(lang);
  };

  return (
    <LanguageContext.Provider value={{ language, changeLanguage }}>
      {children}
    </LanguageContext.Provider>
  );
};
```

---

## 7. 導航架構

### 7.1 Expo Router 路由結構

基於檔案系統的路由：

```
app/
├── _layout.tsx          →  根佈局 (包裝 Providers)
├── (auth)/
│   ├── login.tsx        →  /login
│   └── register.tsx     →  /register
├── (tabs)/
│   ├── _layout.tsx      →  標籤導航佈局
│   ├── index.tsx        →  / (主頁)
│   ├── points.tsx       →  /points
│   ├── coupons.tsx      →  /coupons
│   └── settings.tsx     →  /settings
└── +not-found.tsx       →  404 頁面
```

### 7.2 導航邏輯

```typescript
// app/_layout.tsx - 根佈局
export default function RootLayout() {
  return (
    <LanguageProvider>
      <AuthProvider>
        <Stack screenOptions={{ headerShown: false }}>
          <Stack.Screen name="(tabs)" />
          <Stack.Screen name="(auth)" />
          <Stack.Screen name="+not-found" />
        </Stack>
      </AuthProvider>
    </LanguageProvider>
  );
}
```

```typescript
// app/(tabs)/_layout.tsx - 標籤導航
export default function TabLayout() {
  const { isAuthenticated } = useAuth();

  return (
    <Tabs>
      <Tabs.Screen name="index" options={{ title: t('home.title') }} />
      
      {/* 僅已登入用戶可見 */}
      {isAuthenticated && (
        <>
          <Tabs.Screen name="points" options={{ title: t('points.title') }} />
          <Tabs.Screen name="coupons" options={{ title: t('coupons.title') }} />
          <Tabs.Screen name="settings" options={{ title: t('settings.title') }} />
        </>
      )}
    </Tabs>
  );
}
```

### 7.3 路由守衛

受保護頁面會檢查認證狀態：

```typescript
// 受保護頁面的認證守衛
useEffect(() => {
  if (!authLoading && !isAuthenticated) {
    router.replace('/(tabs)');  // 重定向至主頁
  }
}, [isAuthenticated, authLoading]);
```

---

## 8. 本地儲存策略

### 8.1 儲存方案對比

| 資料類型 | 儲存方案 | 原因 |
|----------|----------|------|
| JWT Token | expo-secure-store | 敏感資料需加密儲存 |
| 語言偏好 | AsyncStorage | 非敏感設定，快速存取 |
| 快取資料 | AsyncStorage | 臨時快取，可清除 |

### 8.2 Token 安全儲存

```typescript
import * as SecureStore from 'expo-secure-store';

// 儲存 Token
await SecureStore.setItemAsync('authToken', token);

// 讀取 Token
const token = await SecureStore.getItemAsync('authToken');

// 刪除 Token
await SecureStore.deleteItemAsync('authToken');
```

### 8.3 語言偏好儲存

```typescript
import AsyncStorage from '@react-native-async-storage/async-storage';

// 儲存語言偏好
await AsyncStorage.setItem('language', 'zh-HK');

// 讀取語言偏好
const language = await AsyncStorage.getItem('language');
```

---

## 9. 第三方依賴

### 9.1 主要依賴

| 套件 | 版本 | 用途 |
|------|------|------|
| expo | 54.0.9 | Expo SDK |
| react-native | 0.81.4 | 核心框架 |
| expo-router | 6.0.7 | 路由導航 |
| expo-secure-store | 15.0.7 | 安全儲存 |
| @react-native-async-storage/async-storage | 2.2.0 | 本地儲存 |
| i18next | 25.7.1 | 國際化 |
| react-i18next | 16.3.5 | React 國際化綁定 |
| expo-notifications | 0.32.13 | 推送通知 |
| react-native-qrcode-svg | 6.3.21 | QR Code 生成 |
| react-native-svg | 15.15.1 | SVG 渲染 |

### 9.2 開發依賴

| 套件 | 用途 |
|------|------|
| typescript | 類型檢查 |
| eslint | 程式碼檢查 |
| jest | 單元測試 |
| jest-expo | Expo 測試適配 |

---

## 10. 安全架構

### 10.1 認證流程

```
┌─────────────┐      ┌─────────────┐      ┌─────────────┐
│   Client    │      │   App       │      │  Backend    │
│   (用戶)     │      │   (App)     │      │   (API)     │
└─────┬───────┘      └──────┬──────┘      └──────┬──────┘
      │                     │                    │
      │ 1. 輸入憑證          │                    │
      ├────────────────────>│                    │
      │                     │ 2. POST /auth/login│
      │                     ├───────────────────>│
      │                     │                    │ 3. 驗證憑證
      │                     │                    │ 4. 生成 JWT
      │                     │ 5. 返回 Token      │
      │                     │<───────────────────┤
      │                     │ 6. SecureStore 儲存 │
      │                     │                    │
      │ 7. 登入成功          │                    │
      │<────────────────────┤                    │
      │                     │                    │
      │ 8. 請求資料          │                    │
      ├────────────────────>│                    │
      │                     │ 9. 附加 Bearer Token│
      │                     ├───────────────────>│
      │                     │                    │ 10. 驗證 Token
      │                     │ 11. 返回資料       │
      │                     │<───────────────────┤
      │ 12. 顯示資料         │                    │
      │<────────────────────┤                    │
```

### 10.2 安全措施

| 措施 | 實現方式 |
|------|----------|
| Token 儲存 | 使用 expo-secure-store 加密儲存 |
| HTTPS | 所有 API 請求使用 HTTPS |
| Token 過期處理 | 401 響應時自動清除 Token 並登出 |
| 敏感資料 | 電郵、電話僅在設定頁顯示 |
| 日誌安全 | 不記錄密碼或 Token |

### 10.3 權限控制

| 頁面/功能 | 訪客 | 會員 |
|-----------|:----:|:----:|
| 主頁（歡迎） | ✓ | ✓ |
| 會員主頁 | ✗ | ✓ |
| 積分頁面 | ✗ | ✓ |
| 優惠券頁面 | ✗ | ✓ |
| 設定頁面 | ✗ | ✓ |
| 登入/註冊 | ✓ | 重定向 |

---

## 11. 附錄

### 11.1 環境配置

| 環境 | 用途 |
|------|------|
| Development | 本地開發，使用 Mock 資料 |
| Staging | 測試環境，連接測試 API |
| Production | 正式環境，連接正式 API |

### 11.2 效能優化

| 優化項目 | 實現方式 |
|----------|----------|
| 列表渲染 | 使用 FlatList 虛擬化 |
| 圖片載入 | expo-image 快取 |
| 重複渲染 | useMemo / useCallback |
| 打包大小 | 按需引入 @expo/vector-icons |

### 11.3 文件修訂記錄

| 版本 | 日期 | 修訂內容 | 作者 |
|------|------|----------|------|
| 1.0 | 2025-12-05 | 初版建立 | - |

---

*文件結束*
